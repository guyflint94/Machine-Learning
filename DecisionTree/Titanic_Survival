import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn import tree
from sklearn.model_selection import train_test_split

df = pd.read_csv('titanic.csv')

inputs = df.drop(['PassengerId','Survived','Name','SibSp','Parch','Ticket','Cabin','Embarked'], axis=1)
target = df.Survived
inputs = inputs.dropna()
target = target[inputs.index]

sex_dummies = pd.get_dummies(inputs.Sex)
sex_dummies = sex_dummies.astype(int)

inputs = inputs.drop(['Sex'], axis=1)
inputs = pd.concat([inputs, sex_dummies], axis=1)

x_train, x_test, y_train, y_test = train_test_split(inputs, target, test_size=0.2)

model = tree.DecisionTreeClassifier(criterion='gini', max_depth=5, random_state=42)
model.fit(x_train, y_train)
y_pred = model.predict(x_test)
score = model.score(x_test, y_test)
print(f"score: {score}")
